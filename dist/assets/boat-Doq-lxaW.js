import"./AuthService-hkblqokD.js";/* empty css              */import"./init-D7pXTd_4.js";const i=(e,n=document)=>n.querySelector(e),P=new URLSearchParams(location.search),B=P.get("id");window.getBoatImageByType=window.getBoatImageByType||function(e,n){console.log("üîç getBoatImageByType appel√©e avec:",{type:e,category:n});const a={voilier:"https://images.unsplash.com/photo-1508599589920-14cfa1c1fe4d?q=80&w=1200&auto=format&fit=crop",catamaran:"https://images.unsplash.com/photo-1544551763-46a013bb70d5?q=80&w=1200&auto=format&fit=crop",yacht:"https://images.unsplash.com/photo-1544551763-46a013bb70d5?q=80&w=1200&auto=format&fit=crop",bateau:"https://images.unsplash.com/photo-1508599589920-14cfa1c1fe4d?q=80&w=1200&auto=format&fit=crop"};if(n==="luxe")return console.log("‚úÖ Cat√©gorie luxe d√©tect√©e, utilisation image premium"),"https://images.unsplash.com/photo-1544551763-46a013bb70d5?q=80&w=1200&auto=format&fit=crop";const l=a[e]||a.bateau;return console.log("‚úÖ Image s√©lectionn√©e:",l),l};const M={boat:null};D().catch(e=>{console.error("Boat detail init failed:",e),h()});async function D(){if(!B)return h();try{console.log("üö§ Chargement du bateau depuis l'API Render...");const e=await fetch(`/api/boats/${B}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok){if(e.status===404)return console.log("‚ùå Bateau non trouv√©"),h();throw new Error(`Erreur ${e.status}: ${e.statusText}`)}const n=await e.json();if(console.log("‚úÖ Donn√©es re√ßues de l'API:",n),n.success&&n.data&&n.data.boat)M.boat=n.data.boat,q(n.data.boat);else return console.error("‚ùå Format de donn√©es invalide:",n),h()}catch(e){return console.error("‚ùå Erreur lors du chargement du bateau:",e),h()}}function q(e){var u,r,p,m,f,U,x,C,L,T,A,E;console.log("üîÑ Hydratation avec les donn√©es:",e),document.title=`${e.name} ‚Äî SailingLoc`,i("#crumb-boat").textContent=e.name,i("#boat-name").textContent=e.name,S("#boat-type",d(e.type)),S("#boat-category",d(e.category)),H("#boat-status",e.status);const n=[(u=e==null?void 0:e.location)==null?void 0:u.marina,(r=e==null?void 0:e.location)==null?void 0:r.city,(p=e==null?void 0:e.location)==null?void 0:p.country].filter(Boolean);i("#boat-location").textContent=n.join(" ‚Ä¢ ");const a=((m=e==null?void 0:e.pricing)==null?void 0:m.dailyRate)??0;i("#price-amount").textContent=y(a),i("#price-details").textContent=`Caution : ${y(((f=e==null?void 0:e.pricing)==null?void 0:f.securityDeposit)??0)} ‚Ç¨`,i("#booking-price").textContent=y(a),i("#booking-deposit").textContent=`${y(((U=e==null?void 0:e.pricing)==null?void 0:U.securityDeposit)??0)} ‚Ç¨`;const l=(x=e==null?void 0:e.capacity)!=null&&x.maxPeople?`${e.capacity.maxPeople} personnes`:"Non sp√©cifi√©",c=(C=e==null?void 0:e.specifications)!=null&&C.length||(L=e==null?void 0:e.specifications)!=null&&L.width?`${((T=e==null?void 0:e.specifications)==null?void 0:T.length)??"‚Äî"}m √ó ${((A=e==null?void 0:e.specifications)==null?void 0:A.width)??"‚Äî"}m`:"Non sp√©cifi√©",o=(E=e==null?void 0:e.specifications)!=null&&E.fuelType?d(e.specifications.fuelType):"Non sp√©cifi√©";i("#boat-capacity").textContent=l,i("#boat-dimensions").textContent=c,i("#boat-engine").textContent=o,i("#boat-description").textContent=(e==null?void 0:e.description)||"Aucune description disponible",N((e==null?void 0:e.amenities)||[]),j(e);let s=[];console.log("üîç [DEBUG] Donn√©es du bateau re√ßues:",{hasImages:Array.isArray(e.images)&&e.images.length>0,hasImageUrls:Array.isArray(e.imageUrls)&&e.imageUrls.length>0,hasImageUrl:e.imageUrl,hasCoverImageUrl:e.coverImageUrl,images:e.images,imageUrls:e.imageUrls,imageUrl:e.imageUrl,coverImageUrl:e.coverImageUrl}),Array.isArray(e.images)&&e.images.length>0?(s=e.images.map(t=>{if(typeof t=="string")return t.startsWith("http")?t:`https://sailingloc.onrender.com${t}`;if(t&&typeof t=="object"){if(t.url)return t.url.startsWith("http")?t.url:`https://sailingloc.onrender.com${t.url}`;if(t.fullUrl)return t.fullUrl.replace("http://localhost:3000","https://sailingloc.onrender.com")}return null}).filter(Boolean),console.log("‚úÖ Images trouv√©es dans boat.images:",s)):Array.isArray(e.imageUrls)&&e.imageUrls.length>0?(s=e.imageUrls.map(t=>typeof t=="string"?t.startsWith("http")?t:`https://sailingloc.onrender.com${t}`:t!=null&&t.fullUrl?t.fullUrl.replace("http://localhost:3000","https://sailingloc.onrender.com"):t!=null&&t.url?t.url.startsWith("http")?t.url:`https://sailingloc.onrender.com${t.url}`:null).filter(Boolean),console.log("‚úÖ Images trouv√©es dans boat.imageUrls:",s)):e.imageUrl?(s=[e.imageUrl.startsWith("http")?e.imageUrl:`https://sailingloc.onrender.com${e.imageUrl}`],console.log("‚úÖ Image trouv√©e dans boat.imageUrl:",s)):e.coverImageUrl?(s=[e.coverImageUrl],console.log("‚úÖ Image trouv√©e dans boat.coverImageUrl:",s)):(console.log("‚ö†Ô∏è Aucune image upload√©e trouv√©e, utilisation image par d√©faut"),s=[window.getBoatImageByType(e.type,e.category)]),console.log("üñºÔ∏è [DEBUG] Images trait√©es pour boat.js:",s),s.length>0&&(console.log("üß™ Test de validit√© des URLs:"),s.forEach((t,v)=>{if(console.log(`  Image ${v+1}: ${t}`),v===0){const w=new Image;w.onload=()=>console.log(`  ‚úÖ Image ${v+1} charg√©e avec succ√®s`),w.onerror=()=>console.log(`  ‚ùå Image ${v+1} erreur de chargement`),w.src=t}})),R(s),k(e);const g=document.getElementById("cta-contact");g&&e&&e._id&&(g.href=`reserve.html?id=${encodeURIComponent(e._id)}`)}function S(e,n){const a=i(e);if(!n){a.style.display="none";return}a.textContent=n}function H(e,n){const a=i(e);if(!n){a.style.display="none";return}const l={available:"Disponible",maintenance:"Maintenance",rented:"Lou√©",inactive:"Inactif"};a.textContent=l[n]||n}function N(e){const n=i("#amenities-grid");if(!e.length){n.innerHTML="<em>Aucun √©quipement renseign√©.</em>";return}n.innerHTML=e.map(a=>`
    <div class="amenity-item"><i>‚úÖ</i><span>${$(a)}</span></div>
  `).join("")}function j(e){var l,c,o,s,g,u,r,p;const n=i("#specs-grid"),a=[["Type",d(e==null?void 0:e.type)||"‚Äî"],["Cat√©gorie",d(e==null?void 0:e.category)||"‚Äî"],["Capacit√©",(l=e==null?void 0:e.capacity)!=null&&l.maxPeople?`${e.capacity.maxPeople} personnes`:"‚Äî"],["Longueur",(c=e==null?void 0:e.specifications)!=null&&c.length?`${e.specifications.length} m`:"‚Äî"],["Largeur",(o=e==null?void 0:e.specifications)!=null&&o.width?`${e.specifications.width} m`:"‚Äî"],["Carburant",(s=e==null?void 0:e.specifications)!=null&&s.fuelType?d(e.specifications.fuelType):"‚Äî"],["Port",((g=e==null?void 0:e.location)==null?void 0:g.marina)||"‚Äî"],["Ville",((u=e==null?void 0:e.location)==null?void 0:u.city)||"‚Äî"],["Pays",((r=e==null?void 0:e.location)==null?void 0:r.country)||"‚Äî"],["Statut",(e==null?void 0:e.status)==="available"?"Disponible":d(e==null?void 0:e.status)||"‚Äî"],["Propri√©taire",((p=e==null?void 0:e.owner)==null?void 0:p.fullName)||"‚Äî"]];n.innerHTML=a.map(([m,f])=>`
    <div class="spec-item">
      <span class="spec-label">${m}</span>
      <span class="spec-value">${$(String(f))}</span>
    </div>
  `).join("")}function R(e){console.log("üñºÔ∏è [DEBUG] renderImages appel√© avec:",e);const n=i("#main-image"),a=i("#thumbs");if(!e||!e.length){console.log("‚ö†Ô∏è Aucune image fournie, utilisation du placeholder"),a.innerHTML="";return}console.log("‚úÖ Affichage de",e.length,"image(s)"),n.innerHTML=`
    <img src="${e[0]}" alt="Photo principale du bateau" onerror="handleImageError(this, '${e[0]}')">
    <div class="image-overlay">
      <button class="gallery-btn gallery-btn-prev" id="prev-image">‚Äπ</button>
      <button class="gallery-btn gallery-btn-next" id="next-image">‚Ä∫</button>
      <div class="image-counter">
        <span id="current-image">1</span> / <span id="total-images">${e.length}</span>
      </div>
    </div>
  `,a.innerHTML=e.slice(0,8).map((l,c)=>`
    <div class="thumbnail ${c===0?"active":""}" data-index="${c}">
      <img src="${l}" alt="Miniature" onerror="handleImageError(this, '${l}')">
    </div>
  `).join(""),a.addEventListener("click",l=>{const c=l.target.closest(".thumbnail");if(!c)return;const o=parseInt(c.dataset.index),s=i("#main-image");s.innerHTML=`
      <img src="${e[o]}" alt="Photo principale du bateau" onerror="handleImageError(this, '${e[o]}')">
      <div class="image-overlay">
        <button class="gallery-btn gallery-btn-prev" id="prev-image">‚Äπ</button>
        <button class="gallery-btn gallery-btn-next" id="next-image">‚Ä∫</button>
        <div class="image-counter">
          <span id="current-image">${o+1}</span> / <span id="total-images">${e.length}</span>
        </div>
      </div>
    `,a.querySelectorAll(".thumbnail").forEach(g=>g.classList.remove("active")),c.classList.add("active"),I(e)}),I(e)}function I(e){const n=i("#prev-image"),a=i("#next-image"),l=i("#current-image");if(!n||!a||!l)return;let c=0;n.addEventListener("click",()=>{c=(c-1+e.length)%e.length,o(e,c)}),a.addEventListener("click",()=>{c=(c+1)%e.length,o(e,c)});function o(s,g){const u=i("#main-image");u.innerHTML=`
      <img src="${s[g]}" alt="Photo principale du bateau" onerror="handleImageError(this, '${s[g]}')">
      <div class="image-overlay">
        <button class="gallery-btn gallery-btn-prev" id="prev-image">‚Äπ</button>
        <button class="gallery-btn gallery-btn-next" id="next-image">‚Ä∫</button>
        <div class="image-counter">
          <span id="current-image">${g+1}</span> / <span id="total-images">${s.length}</span>
        </div>
      </div>
    `,i("#thumbs").querySelectorAll(".thumbnail").forEach((p,m)=>{p.classList.toggle("active",m===g)}),I(s)}}function k(e){const n=i("#reviews-section"),a=i("#rating-stars"),l=i("#rating-value"),c=i("#rating-count"),o=(e==null?void 0:e.reviews)||[],s=o.length;if(!s){n.hidden=!0,i("#rating-wrap").style.display="none";return}const g=Math.round(o.reduce((r,p)=>r+((p==null?void 0:p.rating)||0),0)/s*10)/10;l.textContent=String(g),c.textContent=String(s),a.textContent="‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ",n.hidden=!1;const u=i("#reviews-list");u.innerHTML=o.slice(0,6).map(r=>{var p,m;return`
    <div class="review-item">
      <div class="review-header">
        <div class="reviewer-info">
          <div class="reviewer-avatar">${(((p=r==null?void 0:r.user)==null?void 0:p.firstName)||"A")[0]}</div>
          <div>
            <div class="reviewer-name">${$(((m=r==null?void 0:r.user)==null?void 0:m.fullName)||"Client")}</div>
            <div class="review-date">${new Date((r==null?void 0:r.date)||(r==null?void 0:r.createdAt)||Date.now()).toLocaleDateString("fr-FR")}</div>
          </div>
        </div>
        <div class="review-rating">‚≠ê ${(r==null?void 0:r.rating)??"-"}/5</div>
      </div>
      <div class="review-text">${$((r==null?void 0:r.comment)||"")}</div>
    </div>
  `}).join("")}function h(){const e=document.querySelector(".boat-hero");e&&(e.style.display="none");const n=document.getElementById("boat-not-found");n&&(n.style.display="block")}function y(e){try{return new Intl.NumberFormat("fr-FR").format(e)}catch{return String(e)}}function d(e){return e&&e.charAt(0).toUpperCase()+e.slice(1)}function $(e){return e.replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"})[n])}
